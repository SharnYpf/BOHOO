{% extends 'people_base.html' %}
{% load avatar_tags %}

{% block title %}{{ user.username }}--伯虎{% endblock %}

{% block descrition %}{{ user.username }}--伯虎{% endblock %}

{% block head_other %}
    <style type="text/css">
    .profile-box{
        margin: 0 0 25px;
        clear: both;
        border-radius: 4px;
        border: 2px solid #ddd;
        box-shadow: 0 1px 0 #f2f4f5;
    }
    .profile-box-module{
        position: relative;
        padding: 20px 12px;
    }
    .profile-box-module+.profile-box-module{
        border-top:1px solid #ddd;
    }
    .follow, .unfollow{
        margin-left: 7px;
    }
    </style>
{% endblock %}


{% block left_content %}
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">

               <div class="row-fluid profile-box">
                    <div class="profile-box-module">
                        <div class="row-fluid span12">
                            <div class="container span5">
                                <div class="span12 avatar">
                                    <a href="{% url 'info_view' tid=user.id %}">{{ user.username }}</a>
                                </div>
                                <div class="span12 avatar">
                                    {% avatar user 65 %}
                                </div>
                            </div>
                            <div class="container span7">
                            <div class="container span12">
                            {% if user != request.user %}
                                {% if not is_followed %}
                                    <a data-user_id="{{ user.id }}" class="btn btn-primary pull-left follow">关注</a>
                                    <a data-user_id="{{ user.id }}" class="btn pull-left unfollow" style="display: none;">取消关注</a>
                                {% else %}
                                    <a data-user_id="{{ user.id }}" class="btn pull-left unfollow">取消关注</a>
                                    <a data-user_id="{{ user.id }}" class="btn btn-primary pull-left follow" style="display: none;">>关注</a>
                                {% endif %}
                            {% endif %}
                                <div class="container span12">
                                    <span class="muted pull-left">{{ user.country }}-{{ user.state }}-{{ user.city|default:"无" }}</span>
                                </div>
                                <div class="container span12">
                                    <span class="muted pull-left">{{ user.job|default:"无" }}</span>
                                </div>
                                <div class="container span12">
                                    <span class="muted pull-left">{{ user.sign|default:"无" }}</span>
                                </div>
                            </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="row-fluid info-tab">
                    <ul class="nav nav-pills">
                        <li id="pills-groups" class="active">
                            <a href="">他加入的群组</a>
                        </li>
                        <li id="pills-tadd">
                            <a href="">他发表的话题</a>
                        </li>
                        <li id="pills-reply">
                            <a href="">他回复的话题</a>
                        </li>
                    </ul>
                </div>

            </div>
        </div>
    </div>
{% endblock %}

{% block right_content %}
    <div class="row-fluid info-tab">
        <ul class="nav nav-pills">
            <li id="pills-followed" class="active">
                <a href="">关注了</a>
            </li>
            <li id="pills-follower">
                <a href="">关注者</a>
            </li>
        </ul>
    </div>
{% endblock %}

{% block js_other %}
    <script type="text/javascript">
    $('.follow').bind('click' ,function(e){
        e.preventDefault();
        var self = $(this);
        var user_id = $(this).data('user_id');
        $.ajax({
            url: "{% url 'ajax_follow' %}",
            data: {'user_id': user_id},
            dataType: "json",
            type: 'post',
            success: function(){
                self.hide();
                $('.unfollow', self.parent()).show()
            }
        })
    });

    $('.unfollow').bind('click', function(e){
        e.preventDefault();
        var self = $(this);
        var user_id = $(this).data('user_id');
        $.ajax({
            url: "{% url 'ajax_unfollow' %}",
            data: {'user_id': user_id},
            dataType: "json",
            type: 'post',
            success: function(){
                self.hide();
                $('.follow', self.parent()).show()
            }
        })
    });
    </script>
{% endblock %}